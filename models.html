<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>モデル一覧 - JCFS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Noto Sans JP', system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
    .jcfs-blue-dark { color:#002D4F } .jcfs-blue-primary{ color:#005A9C }
    .bg-jcfs-blue-dark{ background:#002D4F } .bg-jcfs-blue-primary{ background:#005A9C }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

  <!-- Header -->
  <header class="bg-white shadow sticky top-0 z-40">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <a id="nav-home" href="index.html" class="text-2xl font-bold jcfs-blue-dark">JCFS</a>
      <div class="flex items-center gap-2">
        <button id="lang-ja" class="px-3 py-1.5 rounded bg-gray-200 font-semibold">JP</button>
        <button id="lang-en" class="px-3 py-1.5 rounded bg-gray-200 font-semibold">EN</button>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 md:px-6 py-8">
    <h1 id="page-title" class="text-3xl md:text-4xl font-bold jcfs-blue-dark mb-2"></h1>
    <p id="page-desc" class="text-lg text-gray-600 mb-8"></p>

    <!-- スマホ：カード表示 -->
    <div id="cards" class="grid gap-6 md:hidden"></div>

    <!-- PC：テーブル表示 -->
    <div class="hidden md:block bg-white rounded-lg shadow">
      <div class="overflow-x-auto">
        <table class="w-full text-left">
          <thead class="bg-jcfs-blue-primary text-white">
            <tr>
              <th class="px-4 py-3 w-[120px]" id="th-photo"></th>
              <th class="px-4 py-3" id="th-name"></th>
              <th class="px-4 py-3" id="th-size"></th>
              <th class="px-4 py-3" id="th-engine"></th>
              <th class="px-4 py-3" id="th-equip"></th>
              <th class="px-4 py-3 w-[120px]"></th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
        </table>
      </div>
    </div>
  </main>

  <footer class="bg-white mt-12 py-6">
    <p class="text-center text-gray-500 text-sm">&copy; 2024 JCFS. All Rights Reserved.</p>
  </footer>

  <script>
    // ===== プレースホルダ画像（サムネ欠落時に使用） =====
    const NOIMG = 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(
      `<svg xmlns="http://www.w3.org/2000/svg" width="640" height="360">
        <rect width="100%" height="100%" fill="#e5e7eb"/>
        <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle"
              font-family="sans-serif" font-size="20" fill="#6b7280">No Image</text>
      </svg>`
    );
    window.NOIMG = NOIMG;

    // ===== 言語テキスト =====
    const I18N = {
      ja: {
        pageTitle: "モデル一覧",
        pageDesc: "カンボジアの漁業スタイルに合わせたFRP船モデルの一覧です。各モデルの詳細ページでは、写真・仕様・装備をより詳しくご覧いただけます。",
        thPhoto: "写真", thName: "船名", thSize: "サイズ",
        thEngine: "エンジン", thEquip: "装備品", seeDetail: "詳細を見る"
      },
      en: {
        pageTitle: "Model Lineup",
        pageDesc: "A lineup of FRP fishing vessels tailored to Cambodian fisheries. See each detail page for photos, specifications, and equipment.",
        thPhoto: "Photo", thName: "Vessel", thSize: "Size",
        thEngine: "Engine", thEquip: "Equipment", seeDetail: "View details"
      }
    };

    // ===== 一覧データ（ここに増やすだけ！）=====
    const SHIPS = [
      {
        id: "toshigomaru",
        name_ja: "敏五丸",
        name_en: "Toshigomaru",
        size_ja: "総トン数: 2.0t / 全長: 9.15m / 幅: 2.28m",
        size_en: "GT: 2.0t / LOA: 9.15 m / Beam: 2.28 m",
        engine_ja: "ヤンマー ディーゼル 6PH(T,HT),6PHS",
        engine_en: "YANMAR Diesel 6PH(T,HT),6PHS",
        equip_ja: ["魚槽", "魚群探知機", "GPS", "方向探知機"],
        equip_en: ["Fish tank", "Fish finder", "GPS", "Direction finder"],
        thumb: "assets/boats/toshigomaru/01.jpg",
        detailUrl: "model-toshigomaru.html"
      }, // ← ここが重要：カンマ
      {
        id: "Kazumaru",
        name_ja: "第1和丸",
        name_en: "Daiichi Kazu Maru",
        size_ja: "総トン数: 2.25t / 全長: 9.30m / 幅: 1.7m",
        size_en: "GT: 2.25t / LOA: 9.30 m / Beam: 1.7 m",
        engine_ja: "三菱重工業　M6H-MTK",
        engine_en: "Mitsubisi Industry M6H-MTK",
        equip_ja: ["魚槽", "魚群探知機", "GPS","自動航行機", "無線機"],
        equip_en: ["Fish tank", "Fish finder", "GPS", "Auto pilot system","Radio"],
        thumb: "assets/boats/kazumaru/01.jpg",
        detailUrl: "model-kazumaru.html"
      },
      {
        id: "Yuseimaru",
        name_ja: "第3祐勢丸",
        name_en: "Daisan Yusei Maru",
        size_ja: "総トン数: 4.07t / 全長: 9.16m / 幅: 2.42m",
        size_en: "GT: 4.07t / LOA: 9.16 m / Beam: 2.42 m",
        engine_ja: "いすず自動車　UM6BG1TC",
        engine_en: "Isuzu Auto UM6BG1TC",
        equip_ja: ["活魚槽", "魚群探知機", "GPS","方向探知機", "無線機"],
        equip_en: ["Live Fish tank", "Fish finder", "GPS", "Direction finder","Radio"],
        thumb: "assets/boats/yuseimaru/01.jpg",
        detailUrl: "model-yuseimaru.html"
      },
      {
        id: "daiichikazumaru",
        name_ja: "第1和丸",
        name_en: "Daiichi Kazu Maru",
        size_ja: "総トン数: 2.25t / 全長: 9.30m / 幅: 1.7m",
        size_en: "GT: 2.25t / LOA: 9.30 m / Beam: 1.7 m",
        engine_ja: "三菱重工業　M6H-MTK",
        engine_en: "Mitsubisi Industry M6H-MTK",
        equip_ja: ["魚槽", "魚群探知機", "GPS","自動航行機", "無線機"],
        equip_en: ["Fish tank", "Fish finder", "GPS", "Auto pilot system","Radio"],
        thumb: "assets/boats/kazumaru/01.jpg",
        detailUrl: "model-kazumaru.html"
      },
      {
        id: "daiichikazumaru",
        name_ja: "第1和丸",
        name_en: "Daiichi Kazu Maru",
        size_ja: "総トン数: 2.25t / 全長: 9.30m / 幅: 1.7m",
        size_en: "GT: 2.25t / LOA: 9.30 m / Beam: 1.7 m",
        engine_ja: "三菱重工業　M6H-MTK",
        engine_en: "Mitsubisi Industry M6H-MTK",
        equip_ja: ["魚槽", "魚群探知機", "GPS","自動航行機", "無線機"],
        equip_en: ["Fish tank", "Fish finder", "GPS", "Auto pilot system","Radio"],
        thumb: "assets/boats/kazumaru/01.jpg",
        detailUrl: "model-kazumaru.html"
      }
    ];

    // ===== 言語選択（?lang= > localStorage > ブラウザ）=====
    function getInitialLang() {
      const qp = new URLSearchParams(location.search).get("lang");
      if (qp === "ja" || qp === "en") return qp;
      const ls = localStorage.getItem("siteLang");
      if (ls === "ja" || ls === "en") return ls;
      return (navigator.language || "en").toLowerCase().startsWith("ja") ? "ja" : "en";
    }

    function setLang(lang, {persist=true, updateUrl=true} = {}) {
      const t = I18N[lang] || I18N.ja;
      document.documentElement.lang = lang;

      // ヘッダのホームリンクに ?lang を付与（document.baseURI を基準に解決）
      const home = document.getElementById("nav-home");
      if (home) {
        const path = home.getAttribute("href") || "index.html";
        const u = new URL(path, document.baseURI);
        u.searchParams.set("lang", lang);
        home.setAttribute("href", u.pathname + u.search);
      }

      // 表示更新
      document.getElementById("page-title").textContent = t.pageTitle;
      document.getElementById("page-desc").textContent = t.pageDesc;
      document.getElementById("th-photo").textContent = t.thPhoto;
      document.getElementById("th-name").textContent  = t.thName;
      document.getElementById("th-size").textContent  = t.thSize;
      document.getElementById("th-engine").textContent= t.thEngine;
      document.getElementById("th-equip").textContent = t.thEquip;

      // ボタンのアクティブ表示
      document.getElementById("lang-ja").classList.toggle("bg-jcfs-blue-primary", lang === "ja");
      document.getElementById("lang-ja").classList.toggle("text-white", lang === "ja");
      document.getElementById("lang-en").classList.toggle("bg-jcfs-blue-primary", lang === "en");
      document.getElementById("lang-en").classList.toggle("text-white", lang === "en");

      renderList(lang);

      if (persist) localStorage.setItem("siteLang", lang);
      if (updateUrl) {
        const p = new URLSearchParams(location.search);
        p.set("lang", lang);
        history.replaceState(null, "", location.pathname + "?" + p.toString());
      }
    }

    // ===== 一覧描画 =====
    function renderList(lang="ja") {
      const t = I18N[lang] || I18N.ja;

      // カード（スマホ）
      const cards = document.getElementById("cards");
      cards.innerHTML = "";
      SHIPS.forEach(v => {
        const name = (lang === "en" ? v.name_en : v.name_ja) || v.name_ja;
        const size = (lang === "en" ? v.size_en : v.size_ja) || v.size_ja;
        const eng  = (lang === "en" ? v.engine_en : v.engine_ja) || v.engine_ja;
        const eq   = (lang === "en" ? v.equip_en  : v.equip_ja)  || v.equip_ja;
        const detailUrl = appendLang(v.detailUrl, lang);

        const card = document.createElement("div");
        card.className = "bg-white rounded-lg shadow overflow-hidden";

        card.innerHTML = `
          <img src="${v.thumb}" alt="${name} thumbnail"
               class="w-full h-48 object-cover"
               onerror="if(!this.dataset.fallback){this.dataset.fallback=1;this.src=window.NOIMG;}">
          <div class="p-4 space-y-2">
            <h3 class="text-xl font-bold jcfs-blue-dark">${name}</h3>
            <p class="text-sm text-gray-500">${size}</p>
            <p class="text-sm"><span class="font-semibold">${t.thEngine}:</span> ${eng}</p>
            <p class="text-sm"><span class="font-semibold">${t.thEquip}:</span> ${eq.join(" / ")}</p>
            <div class="pt-2">
              <a href="${detailUrl}"
                 class="inline-flex items-center px-4 py-2 rounded-lg text-white bg-gradient-to-r from-[#0e4aa6] via-[#005A9C] to-[#002D4F] font-bold">
                ${t.seeDetail}
              </a>
            </div>
          </div>
        `;
        cards.appendChild(card);
      });

      // テーブル（PC）
      const rows = document.getElementById("rows");
      rows.innerHTML = "";
      SHIPS.forEach(v => {
        const name = (lang === "en" ? v.name_en : v.name_ja) || v.name_ja;
        const size = (lang === "en" ? v.size_en : v.size_ja) || v.size_ja;
        const eng  = (lang === "en" ? v.engine_en : v.engine_ja) || v.engine_ja;
        const eq   = (lang === "en" ? v.equip_en  : v.equip_ja)  || v.equip_ja;
        const detailUrl = appendLang(v.detailUrl, lang);

        const tr = document.createElement("tr");
        tr.className = "border-b hover:bg-gray-50";
        tr.innerHTML = `
          <td class="px-4 py-2">
            <img src="${v.thumb}" alt="${name} thumbnail"
                 class="w-24 h-16 object-cover rounded"
                 onerror="if(!this.dataset.fallback){this.dataset.fallback=1;this.src=window.NOIMG;}">
          </td>
          <td class="px-4 py-2 font-semibold">${name}</td>
          <td class="px-4 py-2 text-sm text-gray-700">${size}</td>
          <td class="px-4 py-2 text-sm text-gray-700">${eng}</td>
          <td class="px-4 py-2 text-sm text-gray-700">${eq.join(" / ")}</td>
          <td class="px-4 py-2">
            <a href="${detailUrl}"
               class="inline-flex items-center px-3 py-2 rounded-lg text-white bg-jcfs-blue-primary hover:bg-jcfs-blue-dark font-bold text-sm">
              ${t.seeDetail}
            </a>
          </td>
        `;
        rows.appendChild(tr);
      });
    }

    // 相対URLを現在ページ基準で解決し、?lang= を付与
    function appendLang(url, lang) {
      try {
        const u = new URL(url, document.baseURI);
        u.searchParams.set("lang", lang);
        return u.pathname + u.search;
      } catch (e) {
        const hasQuery = url.includes("?");
        return url + (hasQuery ? "&" : "?") + "lang=" + lang;
      }
    }

    // 初期化
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("lang-ja").addEventListener("click", () => setLang("ja"));
      document.getElementById("lang-en").addEventListener("click", () => setLang("en"));
      const initLang = getInitialLang();
      setLang(initLang, { persist:true, updateUrl:true });
    });
  </script>
</body>
</html>
